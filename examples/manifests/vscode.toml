# Visual Studio Code manifest for Voidbox
# Install with: voidbox install vscode.toml

[app]
name = "vscode"
display_name = "Visual Studio Code"
description = "Code editing. Redefined."
license = "MIT"

[source]
type = "direct"
url = "https://code.visualstudio.com/sha/download?build=stable&os=linux-x64"
version_url = "https://update.code.visualstudio.com/api/update/linux-x64/stable/latest"
archive_type = "tar.gz"


[runtime]
base = "ubuntu:24.04"
arch = ["x86_64"]

[dependencies]
shared = [
    "curl",
    "unzip",
    "libnss3",
    "libnotify4",
    "libatk1.0-0t64",
    "libatk-bridge2.0-0t64",
    "libcups2t64",
    "libdrm2",
    "libxkbcommon0",
    "libxkbfile1",
    "libxcomposite1",
    "libxdamage1",
    "libxfixes3",
    "libxrandr2",
    "libgbm1",
    "libpango-1.0-0",
    "libcairo2",
    "libasound2t64",  # ALSA audio (required by Electron even if audio disabled)
    "libx11-xcb1",
    "libx11-6",
    "libxcb1",
    "libxss1",
    "libxtst6",
    "libdbus-1-3",
    "libglib2.0-0t64",
    "libgtk-3-0t64",
    "libgtk-3-common",
    "libgl1-mesa-dri",
    "mesa-vulkan-drivers",
    "libegl1",
    "libgles2",
    "libpulse0",
    "libasound2-plugins",
    "libsecret-1-0",
    "fonts-liberation",
    "dconf-gsettings-backend",
    # Required for file picker dialogs
    "gsettings-desktop-schemas",
    "adwaita-icon-theme",
    "hicolor-icon-theme",
    "shared-mime-info",
    "librsvg2-common",
    "xdg-utils",
]

[binary]
name = "code"
install_dir = "vscode"
args = ["--no-sandbox", "--disable-dev-shm-usage", "--user-data-dir=/tmp/.vscode", "--wait"]
path = "bin/code"


[desktop]
categories = ["Development", "IDE", "TextEditor"]
wm_class = "Code"
icon = "resources/app/resources/linux/code.png"
mime_types = [
    "text/plain",
    "application/x-code-workspace",
    "text/x-csrc",
    "text/x-c++src",
    "text/x-chdr",
    "text/x-c++hdr",
    "text/x-python",
    "text/x-python3",
    "application/x-python-code",
    "text/x-java",
    "text/x-javascript",
    "application/javascript",
    "application/json",
    "text/json",
    "application/x-yaml",
    "text/yaml",
    "text/x-yaml",
    "text/markdown",
    "text/x-markdown",
    "text/x-rust",
    "text/x-go",
    "text/x-shellscript",
    "application/x-shellscript",
    "text/x-sh",
    "text/html",
    "text/css",
    "text/xml",
    "application/xml",
    "application/toml",
    "text/x-toml",
    "text/x-lua",
    "text/x-sql",
    "application/sql",
    "text/x-makefile",
    "text/x-cmake",
    "text/x-dockerfile",
    "text/x-diff",
    "text/x-patch",
    "application/x-ruby",
    "text/x-ruby",
    "text/x-perl",
    "text/x-php",
    "application/x-php",
    "text/typescript",
    "application/typescript",
    "text/x-typescript",
    "text/x-tex",
    "text/x-bibtex",
    "application/x-zerosize",
    "inode/x-empty",
]
keywords = ["code", "editor", "development", "programming"]

[permissions]
network = true
audio = false
microphone = false
gpu = true
camera = false
home = true
downloads = true
removable_media = false
dev_mode = true    # VSCode needs access to host tools
native_mode = true # Use host /usr, /lib, PATH - enables gemini, claude, pip, etc.
fonts = true
themes = true
